(function(a){a.fn.QuickSelect=function(b){b=a.extend(true,{iconUp:"&#9650;",iconDown:"&#9660;",minElemsBeforeGoingUp:3,openEffect:"fadeIn",closeEffect:"hide"},b);a(this).filter("select").each(function(){var p=a(this);if(typeof p.data("qs-initialized")!=="undefined"){return}p.data("qs-initialized",true);var l=function(y,z){if(typeof y=="object"){z=y;y=undefined}if(typeof y=="undefined"){y=""}z=a.extend(true,{"class":y},z);return a("<div>",z)};p.hide();var f=a("<a>",{"class":"qs-anchor",href:"#"}).insertAfter(p);var i=l("qs").appendTo(f);var g=l("qs-fixed").appendTo(i);var r=l("qs-dropdown").hide().appendTo(i);var h=l("qs-viewport-arrow").appendTo(g);var d=l("qs-arrow").appendTo(h);var v=l("qs-viewport-container").appendTo(h);var t=l("qs-viewport").appendTo(v);var e=l("qs-shadow-viewport").appendTo(v);var q=function(){v.css({marginRight:d.outerWidth(true)+"px"})};q();d.html(b.iconDown);var m=p.children("option");var c=function(y){var z=y.text();if(z.length==0){z="&nbsp;"}return z};var o=function(){var y=m.filter(function(){return a(this).prop("selected")===true});if(y.length===0){y=m.first().prop("selected",true)}return y};var s=function(B,y){var A;if(typeof y==="undefined"){A=true}else{A=y}var z=a();m.each(function(){if(a(this).is(B)){if(a(this).prop("selected")===true){A=false}a(this).prop("selected",true);z=a(this);a(this).data("qs-mirror").addClass("selected").siblings().removeClass("selected");t.html(c(B))}else{a(this).prop("selected",false)}});if(A){p.trigger("change",[true])}return z};var k=function(y){y.addClass("hover").siblings().removeClass("hover")};var u=function(){var y=0;r.children(".qs-option").slice(0,b.minElemsBeforeGoingUp).each(function(){y+=a(this).outerHeight(true)});return y};var x=function(z){var y=0;r.children(".qs-option").each(function(){var A=a(this).outerHeight(true);if(A+y<z){y+=A}});return y};var w=function(){var A=a(window).height();var F=i.offset();var E=a(window).scrollTop();var y=i.height();var z=A-F.top-y+E;var B=F.top-E;i.removeClass("open-above");if(r.is(":visible")){r.css("max-height","");var C=r.outerHeight();if(C>z){var D=u();if(z>=D||z>=B){r.css("max-height",x(z)+"px")}else{if(B>z){i.addClass("open-above");r.css("max-height",x(B)+"px")}}}}else{if(150>z){i.addClass("open-above")}}};var n=function(){if(r.is(":visible")){j()}else{f.focus();k(o().data("qs-mirror"));r.show();w();r.hide();if(typeof b.openEffect=="function"){b.openEffect.call(r.get(0),{quickSelect:i,original:p,options:b})}else{r.fadeIn(100)}i.addClass("opened")}};var j=function(){if(typeof b.closeEffect=="function"){b.closeEffect.call(r.get(0),{quickSelect:i,original:p,options:b})}else{r.hide()}i.removeClass("opened")};a(window).on("resize",function(){w()});a(window).on("scroll",function(){w()});g.on("click",function(){n()});a(document).on("click",function(A){var z=a(A.target);var y=z.parents().filter(function(){return a(this).is(i)}).length;if(!z.is(i)&&y==0){j()}});m.each(function(){var B=a(this);var y=B.attr("value");var A=a("<div class='qs-option'>").appendTo(r);var z=a("<div class='qs-viewport'>").html(c(B)).appendTo(e);B.data("qs-mirror",A);A.html(c(B));A.attr("data-value",y);A.data("value",y);A.on("mouseenter",function(){k(a(this))});if(B.prop("selected")===true){s(B,false)}A.on("click",function(){s(B);j()})});p.on("change",function(y,z){if(typeof z!=="undefined"){return}s(o())});f.on("click",function(y){y.preventDefault()});f.on("keydown",function(A){if(f.is(":focus")){if(A.which==38||(!r.is(":visible")&&A.which==37)){A.preventDefault();var z=o().prev();if(z.length>0){k(s(z).data("qs-mirror"))}}else{if(A.which==40||(!r.is(":visible")&&A.which==39)){A.preventDefault();var y=o().next();if(y.length>0){k(s(y).data("qs-mirror"))}}else{if(A.which==13){A.preventDefault();n()}else{if(A.which==27){A.preventDefault();j()}}}}}})});return a(this)};a(function(){a("select.quick-select").QuickSelect()})})(jQuery);